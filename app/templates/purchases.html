{% extends 'base.html' %}

{% block title %}êµ¬ë§¤ ëª©ë¡ - MonthlySpecs{% endblock %}

{% block content %}
<div class="card">
    <h2 style="margin-bottom: 1.5rem; color: #2c3e50;">êµ¬ë§¤ ëª©ë¡</h2>
    
    <div style="background: #ecf0f1; padding: 1rem; border-radius: 4px; margin-bottom: 1.5rem;">
        <p style="margin: 0; color: #7f8c8d;">
            <strong>ì‚¬ìš©ì:</strong> {{ user.username }}
            {% if customer.role %}
                | <strong>ì—­í• :</strong> {{ customer.role.get_name_display }}
            {% endif %}
        </p>
    </div>

    <!-- Statistics Cards -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 1.5rem; border-radius: 8px; color: white; text-align: center;">
            <h4 style="margin: 0 0 0.5rem 0; font-size: 0.9rem; opacity: 0.9;">ì´ êµ¬ë§¤ ê±´ìˆ˜</h4>
            <p style="margin: 0; font-size: 2rem; font-weight: bold;">{{ total_purchases }}</p>
        </div>
        <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); padding: 1.5rem; border-radius: 8px; color: white; text-align: center;">
            <h4 style="margin: 0 0 0.5rem 0; font-size: 0.9rem; opacity: 0.9;">ì´ êµ¬ë§¤ ê¸ˆì•¡</h4>
            <p style="margin: 0; font-size: 2rem; font-weight: bold;">â‚©{{ total_spent|floatformat:0 }}</p>
        </div>
        <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); padding: 1.5rem; border-radius: 8px; color: white; text-align: center;">
            <h4 style="margin: 0 0 0.5rem 0; font-size: 0.9rem; opacity: 0.9;">í‰ê·  êµ¬ë§¤ ê¸ˆì•¡</h4>
            <p style="margin: 0; font-size: 2rem; font-weight: bold;">â‚©{{ average_purchase|floatformat:0 }}</p>
        </div>
    </div>

    {% if purchases %}
        <div style="overflow-x: auto;">
            <table style="width: 100%; border-collapse: collapse; background: white;">
                <thead>
                    <tr style="background: #34495e; color: white;">
                        <th style="padding: 1rem; text-align: left; border-bottom: 2px solid #2c3e50;">êµ¬ë§¤ì¼</th>
                        <th style="padding: 1rem; text-align: left; border-bottom: 2px solid #2c3e50;">ìƒí’ˆëª…</th>
                        <th style="padding: 1rem; text-align: center; border-bottom: 2px solid #2c3e50;">ìˆ˜ëŸ‰</th>
                        <th style="padding: 1rem; text-align: right; border-bottom: 2px solid #2c3e50;">ë‹¨ê°€</th>
                        <th style="padding: 1rem; text-align: right; border-bottom: 2px solid #2c3e50;">ì´ ê¸ˆì•¡</th>
                        <th style="padding: 1rem; text-align: left; border-bottom: 2px solid #2c3e50;">ë©”ëª¨</th>
                    </tr>
                </thead>
                <tbody>
                    {% for purchase in purchases %}
                    <tr style="border-bottom: 1px solid #ecf0f1;">
                        <td style="padding: 1rem; color: #7f8c8d;">
                            {{ purchase.purchase_date|date:"Y-m-d H:i" }}
                        </td>
                        <td style="padding: 1rem;">
                            <strong>{{ purchase.item.name }}</strong>
                            {% if purchase.item.description %}
                                <br>
                                <small style="color: #95a5a6;">{{ purchase.item.description|truncatewords:10 }}</small>
                            {% endif %}
                        </td>
                        <td style="padding: 1rem; text-align: center;">
                            <span style="background: #ecf0f1; padding: 0.3rem 0.75rem; border-radius: 4px; font-weight: 600;">
                                {{ purchase.quantity }}
                            </span>
                        </td>
                        <td style="padding: 1rem; text-align: right; color: #7f8c8d;">
                            â‚©{{ purchase.unit_price|floatformat:0 }}
                        </td>
                        <td style="padding: 1rem; text-align: right;">
                            <strong style="color: #2c3e50; font-size: 1.1rem;">â‚©{{ purchase.total_price|floatformat:0 }}</strong>
                        </td>
                        <td style="padding: 1rem; color: #7f8c8d; font-size: 0.9rem;">
                            {{ purchase.notes|default:"â€”" }}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
                <tfoot>
                    <tr style="background: #f8f9fa; font-weight: bold;">
                        <td colspan="4" style="padding: 1rem; text-align: right; border-top: 2px solid #34495e;">
                            ì´ê³„:
                        </td>
                        <td style="padding: 1rem; text-align: right; border-top: 2px solid #34495e; color: #e74c3c; font-size: 1.2rem;">
                            â‚©{{ total_spent|floatformat:0 }}
                        </td>
                        <td style="padding: 1rem; border-top: 2px solid #34495e;"></td>
                    </tr>
                </tfoot>
            </table>
        </div>
    {% else %}
        <div style="text-align: center; padding: 3rem; background: #ecf0f1; border-radius: 4px;">
            <span style="font-size: 3rem; display: block; margin-bottom: 1rem;">ğŸ›’</span>
            <p style="color: #7f8c8d; font-size: 1.1rem; margin: 0;">ì•„ì§ êµ¬ë§¤ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</p>
            <p style="color: #95a5a6; font-size: 0.9rem; margin: 0.5rem 0 0 0;">ì²« êµ¬ë§¤ë¥¼ ì‹œì‘í•´ë³´ì„¸ìš”!</p>
        </div>
    {% endif %}
</div>

<div class="card">
    <h3 style="margin-bottom: 1rem; color: #2c3e50;">ğŸ’¡ ì•ˆë‚´</h3>
    <ul style="color: #7f8c8d; line-height: 1.8;">
        <li>ì´ í˜ì´ì§€ì—ëŠ” íšŒì›ë‹˜ì˜ ëª¨ë“  êµ¬ë§¤ ë‚´ì—­ì´ í‘œì‹œë©ë‹ˆë‹¤.</li>
        <li>êµ¬ë§¤ ë‚´ì—­ì€ ìµœì‹ ìˆœìœ¼ë¡œ ì •ë ¬ë©ë‹ˆë‹¤.</li>
        <li>êµ¬ë§¤ í†µê³„ë¥¼ í†µí•´ ì „ì²´ êµ¬ë§¤ íŒ¨í„´ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
    </ul>
</div>
{% endblock %}
